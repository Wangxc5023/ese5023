<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Section 07 Statistical sleuth: Intermediate</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computing and Programming for Environmental Research</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">
    <span class="fa fa-bell-o"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="Schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="Resource.html">
    <span class="fa fa-wrench"></span>
     
    Resource
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Assignment_01.html">Assignment 01</a>
    </li>
    <li>
      <a href="Assignment_02.html">Assignment 02</a>
    </li>
    <li>
      <a href="Assignment_03.html">Assignment 03</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Section 07 Statistical sleuth: Intermediate</h1>

</div>


<blockquote>
<p>Finding the most important predictor variables (of features) that explains major part of variance of the response variable is key to identify and build high performing models.</p>
</blockquote>
<div id="anova" class="section level1">
<h1>ANOVA</h1>
<p>Analysis of Variance (ANOVA) is a statistical technique, commonly used to study differences between two or more group means. ANOVA test is centred on the different sources of variation in a typical variable. ANOVA in R primarily provides evidence of the existence of the mean equality between the groups. This statistical method is an extension of the t-test. It is used in a situation where the factor variable has more than one group. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div id="one-way-anova" class="section level2">
<h2>One-way ANOVA</h2>
<p>There are many situations where you need to compare the mean between <strong>multiple groups</strong>. For instance, you may want to know the concentration of a certain chemical under 3 different treatments. The ANOVA test can tell if the 3 groups have similar concentration.</p>
<p>To clarify if the data comes from the same population, you can perform a <strong>one-way</strong> analysis of variance (one-way ANOVA hereafter). This test, like any other statistical tests, gives evidence whether the <em>H0</em> hypothesis can be accepted or rejected.</p>
<p>Hypothesis in one-way ANOVA test:</p>
<ul>
<li>Null hypothesis (H0): <strong>The means between groups are identical</strong></li>
<li>Alternative hypothesis: <strong>At least, the mean of one group is different</strong></li>
</ul>
<p>In other words, the H0 hypothesis implies that there is <strong>not enough evidence</strong> to prove the mean of the group (factor) are different from another. This test is similar to the <em>t-test</em>, although ANOVA test is recommended in a situation with more than 2 groups.</p>
<p>Let’s use the <a href="https://zhu-group.github.io/ese5023/download/crop.data.csv">crop dataset</a> to implement the one-way ANOVA test. The dataset contains 96 rows and 4 variables:</p>
<ul>
<li><code>yield</code>: crop yield</li>
<li><code>density</code>: type of soil density: factor level: 1 and 2</li>
<li><code>block</code>: blocking method used: factor level: 1, 2, 3, and 4</li>
<li><code>fertilizer</code>: type of fertilizer used: factor level: 1, 2, and 3</li>
</ul>
<p>In R import the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># Read csv</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">crop_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;crop.data.csv&quot;</span>, <span class="dt">header=</span>T)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># Change to factor type</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">crop_data_tbl &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(crop_data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fertilizer =</span> <span class="kw">factor</span>(fertilizer, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">block =</span> <span class="kw">factor</span>(block, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">factor</span>(density, <span class="dt">ordered =</span> <span class="ot">TRUE</span>))   </a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># Quick check</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">glimpse</span>(crop_data_tbl)</a></code></pre></div>
<pre><code>## Rows: 96
## Columns: 4
## $ density    &lt;ord&gt; 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, …
## $ block      &lt;ord&gt; 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, …
## $ fertilizer &lt;ord&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, …
## $ yield      &lt;dbl&gt; 177.2287, 177.5500, 176.4085, 177.7036, 177.1255, 176.7783, 176.7463, 177.0612, 176.2749, 177.9672,…</code></pre>
<p>Our objective is to test the following assumption:</p>
<ul>
<li>Null: There is <strong>no difference</strong> in crop yield average among fertilizer groups</li>
<li>Alternative: The crop yield average is different for <strong>at least</strong> one fertilizer group.</li>
</ul>
<p>In other words, we want to know if there is a statistical difference between the mean of the crop yeild according to the type of fertilizer.</p>
<p>First, we can check the level of the fertilizer with the following code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">levels</span>(crop_data_tbl<span class="op">$</span>fertilizer)</a></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<p>We can compute the mean and standard deviation:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">crop_data_tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(fertilizer) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    <span class="dt">count =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    <span class="dt">mean_yield =</span> <span class="kw">mean</span>(yield, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    <span class="dt">sd_yield =</span> <span class="kw">sd</span>(yield, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  )</a></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 3 x 4
##   fertilizer count mean_yield sd_yield
##   &lt;ord&gt;      &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;
## 1 1             32       177.    0.685
## 2 2             32       177.    0.574
## 3 3             32       177.    0.599</code></pre>
<p>We can also graphically check if there is a difference between the distribution:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">ggplot</span>(crop_data_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> fertilizer, <span class="dt">y =</span> yield, <span class="dt">fill =</span> fertilizer)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="Section_07_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Finally, we run the one-way ANOVA test with the command <code>aov</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">anova_one_way &lt;-<span class="st"> </span><span class="kw">aov</span>(yield <span class="op">~</span><span class="st"> </span>fertilizer, <span class="dt">data =</span> crop_data_tbl)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">summary</span>(anova_one_way)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## fertilizer   2   6.07  3.0340   7.863  7e-04 ***
## Residuals   93  35.89  0.3859                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The p-value is lower than the usual threshold of 0.05. You are confident to say there is a statistical difference between the groups, indicated by the &quot;***&quot;.</p>
</div>
<div id="pairwise-comparison" class="section level2">
<h2>Pairwise comparison</h2>
<p>The one-way ANOVA test does not inform which group has a different mean. Instead, you can perform a <em>Tukey test</em> with the function <code>TukeyHSD()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">TukeyHSD</span>(anova_one_way)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = yield ~ fertilizer, data = crop_data_tbl)
## 
## $fertilizer
##          diff         lwr       upr     p adj
## 2-1 0.1761687 -0.19371896 0.5460564 0.4954705
## 3-1 0.5991256  0.22923789 0.9690133 0.0006125
## 3-2 0.4229569  0.05306916 0.7928445 0.0208735</code></pre>
</div>
<div id="two-way-anova" class="section level2">
<h2>Two-way ANOVA</h2>
<p>A two-way ANOVA test adds another group variable to the formula. It is identical to the one-way ANOVA test. Hypothesis in two-way ANOVA test:</p>
<ul>
<li>Null: The means are equal for both variables (i.e., factor variable)</li>
<li>Alternative: The means are different for both variables</li>
</ul>
<p>Let’s add <code>block</code> variable to the model. This variable indicates the blocking method used in the land. Now we are interested to see if there is a statistical dependence between the fertilizer type (<code>fertilizer</code>) and blocking method (<code>block</code>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">anova_two_way &lt;-<span class="st"> </span><span class="kw">aov</span>(yield <span class="op">~</span><span class="st"> </span>fertilizer <span class="op">+</span><span class="st"> </span>block, <span class="dt">data =</span> crop_data_tbl)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">summary</span>(anova_two_way)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## fertilizer   2  6.068  3.0340   9.018 0.000269 ***
## block        3  5.608  1.8693   5.556 0.001522 ** 
## Residuals   90 30.278  0.3364                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We can conclude that both fertilizer type (<code>fertilizer</code>) and blocking method (<code>block</code>) are statistically different from 0. We can reject the Null hypothesis and confirm that changing the fertilizer type <strong>or</strong> the blocking method impact the crop yeilds.</p>
</div>
</div>
<div id="multiple-linear-regression" class="section level1">
<h1>Multiple Linear Regression</h1>
<p>We have used the simple linear regression model in the last section, where we assume a linear relationship between a <em>response variable</em> and a single <em>predictor variable</em>. However, it is rarely the case that a dataset will have a single predictor variable. It is also rarely the case that a response variable will only depend on a single variable. So in this chapter, we will extend our current linear model to allow a response to depend on <strong>multiple</strong> predictors.</p>
<p>Let’s use the <code>airquality</code> dataset from the <code>datasets</code> package that comes with R. The dataset contains daily ozone concentration, solar radiation, wind speed, and temperature in New York City from May to September. Load the <code>airquality</code> by:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(datasets)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">library</span>(stats)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw">data</span>(airquality)</a></code></pre></div>
<p>Check the data by</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">str</span>(airquality)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    153 obs. of  6 variables:
##  $ Ozone  : int  41 36 12 18 NA 28 23 19 8 NA ...
##  $ Solar.R: int  190 118 149 313 NA NA 299 99 19 194 ...
##  $ Wind   : num  7.4 8 12.6 11.5 14.3 14.9 8.6 13.8 20.1 8.6 ...
##  $ Temp   : int  67 72 74 62 56 66 65 59 61 69 ...
##  $ Month  : int  5 5 5 5 5 5 5 5 5 5 ...
##  $ Day    : int  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<p>Now we will focus on using three variables, <code>Solar.R</code>, <code>Wind</code>, and <code>Temp</code>, as predictor variables. That is, we would like to model the ozone contraction as a function of solar radiation, wind speed, and temperature. To do so, we will define the following linear model:</p>
<p><span class="math display">\[y_{i}  = \beta_{0} + \beta_{1}x_{i1} + \beta_{2}x_{i2} + \beta_{3}x_{i3} + \epsilon_{i},  i = 1,2,3,...,n\]</span></p>
<p>where <span class="math inline">\(\epsilon_{i}\)</span> ~ <span class="math inline">\(N(0, \sigma^{2})\)</span>. In this notation, we will define:</p>
<ul>
<li><span class="math inline">\(x_{i1}\)</span> as the solar radiation (<code>Solar.R</code>) of the <em>i</em>th day.</li>
<li><span class="math inline">\(x_{i2}\)</span> as the wind speed (<code>Wind</code>) of the <em>i</em>th day.</li>
<li><span class="math inline">\(x_{i3}\)</span> as the temperature (<code>Temp</code>) of the <em>i</em>th day.</li>
</ul>
<p>The data points (<span class="math inline">\(x_{i1}, x_{i2}, x_{i3}, y_{i}\)</span>) now exist in 4-dimensional space, so instead of fitting a line as we did in the simple linear regression model to the data, we will fit a 3-dimensional space.</p>
<p>Before the linear regression model can be applied, one must verify multiple factors and make sure assumptions are met. Most of all, one must make sure <em>linearity</em> exists between the variables in the dataset. One of the fastest ways to check the linearity is by using scatter plots.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># plotting the data to determine the linearity</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">plot</span>(airquality, <span class="dt">main=</span><span class="st">&quot;Matrix Scatterplot&quot;</span>)</a></code></pre></div>
<p><img src="Section_07_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>From the above scatter plot we can determine the variables <code>Ozone</code>, <code>Solar.R</code>, <code>Wind</code>, and <code>Temp</code> in the database <code>airquality</code> are in linearity.</p>
<p>In R, the multiple linear regression is done as:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(Ozone <span class="op">~</span><span class="st"> </span>Wind <span class="op">+</span><span class="st"> </span>Temp <span class="op">+</span><span class="st"> </span>Solar.R, <span class="dt">data =</span> airquality)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">coef</span>(model)</a></code></pre></div>
<pre><code>##  (Intercept)         Wind         Temp      Solar.R 
## -64.34207893  -3.33359131   1.65209291   0.05982059</code></pre>
<p><span class="math display">\[y_{i}  = -64.34 + -3.33x_{i1} + 1.65x_{i2} + 0.060x_{i3}\]</span> Here we have fitted our model using <code>lm()</code>, however, we have introduced a new syntactical element. The formula <code>Ozone ~ Wind + Temp + Solar.R</code> reads: “model the response variable <code>Ozone</code> as a linear function of <code>Wind</code>, <code>Temp</code>, and <code>Solar.R</code>”. That is, it will estimate an intercept, as well as slope coefficients for <code>Wind</code>, <code>Temp</code>, and <code>Solar.R</code>. We then extract these as we have done before using <code>coef()</code>.</p>
<p>The model can be further explored with the <code>summary()</code> function:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">summary</span>(model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Ozone ~ Wind + Temp + Solar.R, data = airquality)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -40.485 -14.219  -3.551  10.097  95.619 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -64.34208   23.05472  -2.791  0.00623 ** 
## Wind         -3.33359    0.65441  -5.094 1.52e-06 ***
## Temp          1.65209    0.25353   6.516 2.42e-09 ***
## Solar.R       0.05982    0.02319   2.580  0.01124 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 21.18 on 107 degrees of freedom
##   (42 observations deleted due to missingness)
## Multiple R-squared:  0.6059, Adjusted R-squared:  0.5948 
## F-statistic: 54.83 on 3 and 107 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In the above model, we assume that all the predictor variables are <strong>independent</strong> of each other. However, such assumption is falwed as we can see from the Matrix Scatterplot that <code>Temp</code> corrlates with <code>Wind</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">cor</span>(airquality<span class="op">$</span>Wind, airquality<span class="op">$</span>Temp)</a></code></pre></div>
<pre><code>## [1] -0.4579879</code></pre>
<p>Such <strong>interaction variables</strong> introduce an additional level of regression analysis by allowing researchers to explore the synergistic effects of combined predictors. In R, you can interact two variables by using a colon <code>:</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Ozone <span class="op">~</span><span class="st"> </span>Wind <span class="op">+</span><span class="st"> </span>Temp <span class="op">+</span><span class="st"> </span>Solar.R <span class="op">+</span><span class="st"> </span>Wind<span class="op">:</span>Temp, <span class="dt">data =</span> airquality)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw">summary</span>(model2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Ozone ~ Wind + Temp + Solar.R + Wind:Temp, data = airquality)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -38.888 -11.938  -3.084   8.753  94.235 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -245.08368   46.84632  -5.232 8.53e-07 ***
## Wind          14.38471    4.13249   3.481 0.000727 ***
## Temp           3.91373    0.57217   6.840 5.26e-10 ***
## Solar.R        0.06599    0.02152   3.067 0.002745 ** 
## Wind:Temp     -0.22795    0.05259  -4.334 3.34e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.61 on 106 degrees of freedom
##   (42 observations deleted due to missingness)
## Multiple R-squared:  0.6652, Adjusted R-squared:  0.6526 
## F-statistic: 52.66 on 4 and 106 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Indeed the interaction term has a signiicant slope, so you may want to include this term in your linear model.</p>
<hr />
</div>
<div id="overfitting-in-regression-model" class="section level1">
<h1>Overfitting in Regression Model</h1>
<p>Overfitting a regression model occurs when you <strong>attempt to estimate too many parameters from a sample that is too small</strong>. Regression analysis uses one sample to estimate the values of the coefficients for all of the terms in the equation. The sample size limits the number of terms that you can safely include before you begin to overfit the model.</p>
<p>Larger sample sizes allow you to specify more complex models. For trustworthy results, your sample size must be <strong>large enough</strong> to support the level of complexity that is required by your research question. If your sample size isn’t large enough, you won’t be able to fit a model that adequately approximates the true model for your response variable. You won’t be able to trust the results.</p>
<p>You must have a sufficient number of observations for each term in a regression model. Simulation studies show that a good rule of thumb is to have <strong>10-15 observations per term</strong> in multiple linear regression. For example, if your model contains two predictors and the interaction term, you’ll need 30-45 observations. However, if the effect size is small or there is high multicollinearity, you may need more observations per term. <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>Let’s demonstrate the idea by adding more fake variables to the linear model.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">N              &lt;-<span class="st"> </span><span class="kw">dim</span>(airquality)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">Fake           &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim=</span><span class="kw">c</span>(N,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">airquality_new &lt;-<span class="st"> </span>airquality</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co"># Generate some fake observations</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">  Fake[,i]     &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co"># Attach to the original data</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11">airquality_new &lt;-<span class="st"> </span><span class="kw">cbind</span>(airquality,Fake)</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">airquality_new &lt;-<span class="st"> </span>airquality_new[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,]</a>
<a class="sourceLine" id="cb27-13" data-line-number="13"></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co"># Change column names</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="kw">colnames</span>(airquality_new)[<span class="dv">7</span><span class="op">:</span><span class="dv">16</span>] =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Fake&quot;</span>,<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb27-16" data-line-number="16"></a>
<a class="sourceLine" id="cb27-17" data-line-number="17"><span class="co"># Fit linear model</span></a>
<a class="sourceLine" id="cb27-18" data-line-number="18">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Ozone <span class="op">~</span><span class="st"> </span>Fake1 <span class="op">+</span><span class="st"> </span>Fake2 <span class="op">+</span><span class="st"> </span>Fake3 <span class="op">+</span><span class="st"> </span>Fake4 <span class="op">+</span><span class="st"> </span>Fake5 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-19" data-line-number="19"><span class="st">            </span>Fake6 <span class="op">+</span><span class="st"> </span>Fake7 <span class="op">+</span><span class="st"> </span>Fake8 <span class="op">+</span><span class="st"> </span>Fake9 <span class="op">+</span><span class="st"> </span>Fake10, <span class="dt">data =</span> airquality_new)</a>
<a class="sourceLine" id="cb27-20" data-line-number="20"><span class="kw">summary</span>(fit)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Ozone ~ Fake1 + Fake2 + Fake3 + Fake4 + Fake5 + 
##     Fake6 + Fake7 + Fake8 + Fake9 + Fake10, data = airquality_new)
## 
## Residuals:
##       1       2       3       4       6       7       8       9      11      12      13      14      15 
##  5.7096  4.6031  1.6119 -7.2035  3.6295 -0.6381 -5.8077  4.4704 -5.0151 -1.3821 -6.7202  0.1281  6.6141 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  17.0134    10.5100   1.619    0.247
## Fake1         4.1084     8.8534   0.464    0.688
## Fake2         3.9880    10.9237   0.365    0.750
## Fake3        -5.9883    19.5390  -0.306    0.788
## Fake4        -2.6771    15.2750  -0.175    0.877
## Fake5         1.7974     6.1652   0.292    0.798
## Fake6        -0.9776     9.7427  -0.100    0.929
## Fake7         2.4175     9.6872   0.250    0.826
## Fake8         2.0809     6.8343   0.304    0.790
## Fake9         5.8744    10.9724   0.535    0.646
## Fake10        2.6778     6.3366   0.423    0.714
## 
## Residual standard error: 12.07 on 2 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.7727, Adjusted R-squared:  -0.3637 
## F-statistic: 0.6799 on 10 and 2 DF,  p-value: 0.7245</code></pre>
<p>You can see the high <span class="math inline">\(R^{2}\)</span> doesn’t make any sense, as the linear model has no valid observations.</p>
<hr />
</div>
<div id="variable-selection" class="section level1">
<h1>Variable Selection</h1>
<p>We use Boston Housing Data as an illustrative example. Boston housing data is a built-in dataset in <code>MASS</code> package, so you do not need to download externally. Package <code>MASS</code> comes with R when you installed R, so <strong>no need</strong> to use <code>install.packages(MASS)</code> to download and install, but you do need to load this package. <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">data</span>(Boston); <span class="co">#this data is in MASS package</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw">str</span>(Boston)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    506 obs. of  14 variables:
##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
##  $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
##  $ black  : num  397 397 393 395 397 ...
##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...</code></pre>
<p>The original data are 506 observations on 14 variables, <code>medv</code> being the response variable <em>y</em>.</p>
<p>We usually split our data to training and testing samples. In this case, we sample 90% of the original data and use it as the <em>training set</em>. The remaining 10% is used as <em>test set</em>. The regression model will be built on the training set, and future performance of your model will be evaluated with the test set.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">sample_index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(Boston),<span class="kw">nrow</span>(Boston)<span class="op">*</span><span class="fl">0.90</span>)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">Boston_train &lt;-<span class="st"> </span>Boston[sample_index,]</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">Boston_test  &lt;-<span class="st"> </span>Boston[<span class="op">-</span>sample_index,]</a></code></pre></div>
<p>What we want to do next is to build a <strong>best</strong> model with training data. Let’s begin with including all <em>x</em> variables in the model:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">model_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(medv<span class="op">~</span>crim<span class="op">+</span>zn<span class="op">+</span>chas<span class="op">+</span>nox<span class="op">+</span>rm<span class="op">+</span>dis<span class="op">+</span>rad<span class="op">+</span>tax<span class="op">+</span>ptratio<span class="op">+</span>black<span class="op">+</span>lstat, <span class="dt">data=</span>Boston_train)</a></code></pre></div>
<p>To include all variables in the model, you can write the statement this simpler way.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">model_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>Boston_train)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">summary</span>(model_<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ ., data = Boston_train)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.3529  -2.4955  -0.4703   1.8118  26.8408 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  36.696301   5.184477   7.078 5.79e-12 ***
## crim         -0.119776   0.034256  -3.496 0.000519 ***
## zn            0.042629   0.014074   3.029 0.002598 ** 
## indus        -0.008990   0.060210  -0.149 0.881376    
## chas          1.934430   0.855487   2.261 0.024233 *  
## nox         -16.086106   3.877914  -4.148 4.02e-05 ***
## rm            3.820073   0.419969   9.096  &lt; 2e-16 ***
## age           0.005593   0.013301   0.421 0.674323    
## dis          -1.449162   0.204890  -7.073 5.99e-12 ***
## rad           0.285804   0.065475   4.365 1.58e-05 ***
## tax          -0.012583   0.003663  -3.435 0.000648 ***
## ptratio      -1.037885   0.134153  -7.737 7.02e-14 ***
## black         0.010333   0.002646   3.905 0.000109 ***
## lstat        -0.504770   0.050470 -10.001  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.504 on 441 degrees of freedom
## Multiple R-squared:  0.7619, Adjusted R-squared:  0.7549 
## F-statistic: 108.5 on 13 and 441 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="best-subset-regression" class="section level2">
<h2>Best subset regression</h2>
<p>You can use the <code>leaps</code> package to get the best subset regression.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co">#install.packages(&#39;leaps&#39;)</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">library</span>(leaps)</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">subset_result &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>Boston_train, <span class="dt">nbest=</span><span class="dv">2</span>, <span class="dt">nvmax =</span> <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="kw">plot</span>(subset_result, <span class="dt">scale=</span><span class="st">&quot;bic&quot;</span>)</a></code></pre></div>
<p><img src="Section_07_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Here <code>nbest</code> is the number of subsets of each size to record, and we use <code>2</code> so that each time R compares <code>2</code> variables. <code>nvmax</code> is the maximum size of subsets to examine; this is set to <code>14</code> to consider all the variables in the <code>Boston_train</code> dataset.</p>
<p>Each row represents a model. Black indicates that a variable is included in the model, while white indicates that it is not. The argument <code>scale = &quot;&quot;</code> can be <code>Cp</code>, <code>adjr2</code>, <code>r2</code>, or <code>bic</code>.</p>
<ul>
<li><p>AIC stands for (Akaike’s Information Criteria), a metric developed by the Japanese Statistician, Hirotugu Akaike, 1970. The basic idea of AIC is to penalize the inclusion of additional variables to a model. It adds a penalty that increases the error when including additional terms. <strong>The lower the AIC, the better the model</strong>.</p></li>
<li><p>AICc is a version of AIC corrected for small sample sizes.</p></li>
<li><p>BIC (or Bayesian information criteria) is a variant of AIC with a stronger penalty for including additional variables to the model.</p></li>
<li><p>Mallows Cp: A variant of AIC developed by Colin Mallows.</p></li>
</ul>
<p>What is the problem with the best subset regression? If there are <em>n</em> independent variables, the number of possible nonempty subsets is <span class="math inline">\(2^{n}-1\)</span>. If you try a best subset regression with more than 50 variables, you might need to wait for your entire life to get the result.</p>
</div>
<div id="variable-selection-using-aic" class="section level2">
<h2>Variable Selection Using AIC</h2>
<p>To perform the forward/backward/stepwise regression in R, we need to define the starting points:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">nullmodel=<span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span>Boston_train)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">fullmodel=<span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>Boston_train)</a></code></pre></div>
<p>The nullmodel is the model with <strong>no</strong> variable in it, while the fullmodel is the model with <strong>every</strong> variable in it.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># Backward Elimination</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">model_step_b &lt;-<span class="st"> </span><span class="kw">step</span>(fullmodel,<span class="dt">direction=</span><span class="st">&#39;backward&#39;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=1383.21
## medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + 
##     tax + ptratio + black + lstat
## 
##           Df Sum of Sq     RSS    AIC
## - indus    1      0.45  8944.7 1381.2
## - age      1      3.59  8947.9 1381.4
## &lt;none&gt;                  8944.3 1383.2
## - chas     1    103.70  9048.0 1386.5
## - zn       1    186.09  9130.4 1390.6
## - tax      1    239.33  9183.6 1393.2
## - crim     1    247.95  9192.2 1393.7
## - black    1    309.27  9253.6 1396.7
## - nox      1    348.99  9293.3 1398.6
## - rad      1    386.45  9330.7 1400.5
## - dis      1   1014.61  9958.9 1430.1
## - ptratio  1   1213.96 10158.2 1439.1
## - rm       1   1678.09 10622.4 1459.4
## - lstat    1   2028.74 10973.0 1474.2
## 
## Step:  AIC=1381.23
## medv ~ crim + zn + chas + nox + rm + age + dis + rad + tax + 
##     ptratio + black + lstat
## 
##           Df Sum of Sq     RSS    AIC
## - age      1      3.56  8948.3 1379.4
## &lt;none&gt;                  8944.7 1381.2
## - chas     1    103.31  9048.1 1384.5
## - zn       1    189.84  9134.6 1388.8
## - crim     1    247.50  9192.2 1391.7
## - tax      1    302.51  9247.2 1394.4
## - black    1    310.82  9255.6 1394.8
## - nox      1    376.62  9321.4 1398.0
## - rad      1    422.18  9366.9 1400.2
## - dis      1   1058.53 10003.3 1430.1
## - ptratio  1   1232.06 10176.8 1437.9
## - rm       1   1706.62 10651.4 1458.7
## - lstat    1   2039.97 10984.7 1472.7
## 
## Step:  AIC=1379.41
## medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + 
##     black + lstat
## 
##           Df Sum of Sq     RSS    AIC
## &lt;none&gt;                  8948.3 1379.4
## - chas     1    105.55  9053.9 1382.8
## - zn       1    186.47  9134.8 1386.8
## - crim     1    247.70  9196.0 1389.8
## - tax      1    300.60  9248.9 1392.4
## - black    1    317.01  9265.3 1393.2
## - nox      1    388.13  9336.4 1396.7
## - rad      1    418.65  9367.0 1398.2
## - dis      1   1207.37 10155.7 1435.0
## - ptratio  1   1229.16 10177.5 1436.0
## - rm       1   1820.89 10769.2 1461.7
## - lstat    1   2229.27 11177.6 1478.6</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># Forward Selection</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">model_step_f &lt;-<span class="st"> </span><span class="kw">step</span>(nullmodel, <span class="dt">scope=</span><span class="kw">list</span>(<span class="dt">lower=</span>nullmodel, <span class="dt">upper=</span>fullmodel), <span class="dt">direction=</span><span class="st">&#39;forward&#39;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=2010.14
## medv ~ 1
## 
##           Df Sum of Sq   RSS    AIC
## + lstat    1   20861.1 16702 1643.4
## + rm       1   18603.3 18960 1701.1
## + ptratio  1   10778.3 26785 1858.3
## + tax      1    9165.4 28398 1884.9
## + indus    1    9127.0 28436 1885.5
## + nox      1    6938.8 30625 1919.2
## + crim     1    6312.2 31251 1928.4
## + rad      1    6196.6 31367 1930.1
## + age      1    4925.6 32638 1948.2
## + zn       1    4556.9 33007 1953.3
## + black    1    4084.9 33479 1959.8
## + dis      1    2418.3 35145 1981.9
## + chas     1    1307.0 36256 1996.0
## &lt;none&gt;                 37563 2010.1
## 
## Step:  AIC=1643.37
## medv ~ lstat
## 
##           Df Sum of Sq   RSS    AIC
## + rm       1    3725.7 12977 1530.5
## + ptratio  1    2642.3 14060 1567.0
## + dis      1     672.5 16030 1626.7
## + chas     1     582.1 16120 1629.2
## + tax      1     440.7 16262 1633.2
## + age      1     355.4 16347 1635.6
## + black    1     259.6 16443 1638.2
## + crim     1     186.9 16515 1640.2
## + indus    1     146.9 16555 1641.3
## + rad      1      97.0 16605 1642.7
## + zn       1      95.7 16607 1642.8
## &lt;none&gt;                 16702 1643.4
## + nox      1       2.6 16700 1645.3
## 
## Step:  AIC=1530.53
## medv ~ lstat + rm
## 
##           Df Sum of Sq   RSS    AIC
## + ptratio  1   1765.58 11211 1466.0
## + tax      1    630.68 12346 1509.9
## + black    1    576.75 12400 1511.8
## + crim     1    375.15 12602 1519.2
## + rad      1    349.12 12628 1520.1
## + chas     1    338.60 12638 1520.5
## + dis      1    240.87 12736 1524.0
## + indus    1    108.07 12869 1528.7
## &lt;none&gt;                 12977 1530.5
## + zn       1     38.45 12938 1531.2
## + nox      1     30.12 12946 1531.5
## + age      1     24.15 12952 1531.7
## 
## Step:  AIC=1465.98
## medv ~ lstat + rm + ptratio
## 
##         Df Sum of Sq   RSS    AIC
## + black  1    472.21 10739 1448.4
## + dis    1    377.60 10834 1452.4
## + chas   1    210.56 11000 1459.4
## + crim   1    162.09 11049 1461.4
## + tax    1    125.72 11085 1462.8
## + age    1     70.21 11141 1465.1
## &lt;none&gt;               11211 1466.0
## + nox    1     37.07 11174 1466.5
## + zn     1     20.94 11190 1467.1
## + rad    1      8.60 11202 1467.6
## + indus  1      4.94 11206 1467.8
## 
## Step:  AIC=1448.4
## medv ~ lstat + rm + ptratio + black
## 
##         Df Sum of Sq   RSS    AIC
## + dis    1    498.49 10240 1428.8
## + chas   1    193.52 10545 1442.1
## + age    1     91.01 10648 1446.5
## + crim   1     72.95 10666 1447.3
## &lt;none&gt;               10739 1448.4
## + zn     1     28.78 10710 1449.2
## + tax    1     24.21 10715 1449.4
## + rad    1     15.43 10723 1449.8
## + indus  1      4.41 10734 1450.2
## + nox    1      0.96 10738 1450.4
## 
## Step:  AIC=1428.78
## medv ~ lstat + rm + ptratio + black + dis
## 
##         Df Sum of Sq     RSS    AIC
## + nox    1    478.30  9762.1 1409.0
## + indus  1    196.44 10043.9 1422.0
## + tax    1    177.04 10063.3 1422.8
## + crim   1    154.29 10086.1 1423.9
## + chas   1    118.75 10121.6 1425.5
## + zn     1     96.22 10144.1 1426.5
## &lt;none&gt;               10240.4 1428.8
## + age    1     37.33 10203.0 1429.1
## + rad    1      7.29 10233.1 1430.5
## 
## Step:  AIC=1409.01
## medv ~ lstat + rm + ptratio + black + dis + nox
## 
##         Df Sum of Sq    RSS    AIC
## + chas   1   152.701 9609.4 1403.8
## + crim   1   104.314 9657.7 1406.1
## + zn     1   101.166 9660.9 1406.3
## + rad    1    45.142 9716.9 1408.9
## &lt;none&gt;               9762.1 1409.0
## + indus  1    35.066 9727.0 1409.4
## + tax    1    16.662 9745.4 1410.2
## + age    1     0.056 9762.0 1411.0
## 
## Step:  AIC=1403.84
## medv ~ lstat + rm + ptratio + black + dis + nox + chas
## 
##         Df Sum of Sq    RSS    AIC
## + zn     1   106.420 9502.9 1400.8
## + crim   1    91.994 9517.4 1401.5
## + rad    1    46.326 9563.0 1403.6
## + indus  1    42.673 9566.7 1403.8
## &lt;none&gt;               9609.4 1403.8
## + tax    1    11.493 9597.9 1405.3
## + age    1     0.154 9609.2 1405.8
## 
## Step:  AIC=1400.77
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn
## 
##         Df Sum of Sq    RSS    AIC
## + crim   1   129.269 9373.7 1396.5
## + indus  1    42.859 9460.1 1400.7
## &lt;none&gt;               9502.9 1400.8
## + tax    1    38.028 9464.9 1401.0
## + rad    1    25.725 9477.2 1401.5
## + age    1     0.719 9502.2 1402.7
## 
## Step:  AIC=1396.54
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn + 
##     crim
## 
##         Df Sum of Sq    RSS    AIC
## + rad    1   124.757 9248.9 1392.4
## + indus  1    42.736 9330.9 1396.5
## &lt;none&gt;               9373.7 1396.5
## + tax    1     6.708 9367.0 1398.2
## + age    1     0.094 9373.6 1398.5
## 
## Step:  AIC=1392.44
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn + 
##     crim + rad
## 
##         Df Sum of Sq    RSS    AIC
## + tax    1   300.604 8948.3 1379.4
## + indus  1    63.130 9185.8 1391.3
## &lt;none&gt;               9248.9 1392.4
## + age    1     1.662 9247.2 1394.4
## 
## Step:  AIC=1379.41
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn + 
##     crim + rad + tax
## 
##         Df Sum of Sq    RSS    AIC
## &lt;none&gt;               8948.3 1379.4
## + age    1    3.5641 8944.7 1381.2
## + indus  1    0.4300 8947.9 1381.4</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># Stepwise Selection </span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2">model_step_s &lt;-<span class="st"> </span><span class="kw">step</span>(nullmodel, <span class="dt">scope=</span><span class="kw">list</span>(<span class="dt">lower=</span>nullmodel, <span class="dt">upper=</span>fullmodel), <span class="dt">direction=</span><span class="st">&#39;both&#39;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=2010.14
## medv ~ 1
## 
##           Df Sum of Sq   RSS    AIC
## + lstat    1   20861.1 16702 1643.4
## + rm       1   18603.3 18960 1701.1
## + ptratio  1   10778.3 26785 1858.3
## + tax      1    9165.4 28398 1884.9
## + indus    1    9127.0 28436 1885.5
## + nox      1    6938.8 30625 1919.2
## + crim     1    6312.2 31251 1928.4
## + rad      1    6196.6 31367 1930.1
## + age      1    4925.6 32638 1948.2
## + zn       1    4556.9 33007 1953.3
## + black    1    4084.9 33479 1959.8
## + dis      1    2418.3 35145 1981.9
## + chas     1    1307.0 36256 1996.0
## &lt;none&gt;                 37563 2010.1
## 
## Step:  AIC=1643.37
## medv ~ lstat
## 
##           Df Sum of Sq   RSS    AIC
## + rm       1    3725.7 12977 1530.5
## + ptratio  1    2642.3 14060 1567.0
## + dis      1     672.5 16030 1626.7
## + chas     1     582.1 16120 1629.2
## + tax      1     440.7 16262 1633.2
## + age      1     355.4 16347 1635.6
## + black    1     259.6 16443 1638.2
## + crim     1     186.9 16515 1640.2
## + indus    1     146.9 16555 1641.3
## + rad      1      97.0 16605 1642.7
## + zn       1      95.7 16607 1642.8
## &lt;none&gt;                 16702 1643.4
## + nox      1       2.6 16700 1645.3
## - lstat    1   20861.1 37563 2010.1
## 
## Step:  AIC=1530.53
## medv ~ lstat + rm
## 
##           Df Sum of Sq   RSS    AIC
## + ptratio  1    1765.6 11211 1466.0
## + tax      1     630.7 12346 1509.9
## + black    1     576.8 12400 1511.8
## + crim     1     375.1 12602 1519.2
## + rad      1     349.1 12628 1520.1
## + chas     1     338.6 12638 1520.5
## + dis      1     240.9 12736 1524.0
## + indus    1     108.1 12869 1528.7
## &lt;none&gt;                 12977 1530.5
## + zn       1      38.4 12938 1531.2
## + nox      1      30.1 12946 1531.5
## + age      1      24.1 12952 1531.7
## - rm       1    3725.7 16702 1643.4
## - lstat    1    5983.5 18960 1701.1
## 
## Step:  AIC=1465.98
## medv ~ lstat + rm + ptratio
## 
##           Df Sum of Sq   RSS    AIC
## + black    1     472.2 10739 1448.4
## + dis      1     377.6 10834 1452.4
## + chas     1     210.6 11000 1459.4
## + crim     1     162.1 11049 1461.4
## + tax      1     125.7 11085 1462.8
## + age      1      70.2 11141 1465.1
## &lt;none&gt;                 11211 1466.0
## + nox      1      37.1 11174 1466.5
## + zn       1      20.9 11190 1467.1
## + rad      1       8.6 11202 1467.6
## + indus    1       4.9 11206 1467.8
## - ptratio  1    1765.6 12977 1530.5
## - rm       1    2849.0 14060 1567.0
## - lstat    1    4270.4 15482 1610.8
## 
## Step:  AIC=1448.4
## medv ~ lstat + rm + ptratio + black
## 
##           Df Sum of Sq   RSS    AIC
## + dis      1    498.49 10240 1428.8
## + chas     1    193.52 10545 1442.1
## + age      1     91.01 10648 1446.5
## + crim     1     72.95 10666 1447.3
## &lt;none&gt;                 10739 1448.4
## + zn       1     28.78 10710 1449.2
## + tax      1     24.21 10715 1449.4
## + rad      1     15.43 10723 1449.8
## + indus    1      4.41 10734 1450.2
## + nox      1      0.96 10738 1450.4
## - black    1    472.21 11211 1466.0
## - ptratio  1   1661.04 12400 1511.8
## - lstat    1   3004.59 13743 1558.7
## - rm       1   3113.75 13853 1562.2
## 
## Step:  AIC=1428.78
## medv ~ lstat + rm + ptratio + black + dis
## 
##           Df Sum of Sq     RSS    AIC
## + nox      1     478.3  9762.1 1409.0
## + indus    1     196.4 10043.9 1422.0
## + tax      1     177.0 10063.3 1422.8
## + crim     1     154.3 10086.1 1423.9
## + chas     1     118.8 10121.6 1425.5
## + zn       1      96.2 10144.1 1426.5
## &lt;none&gt;                 10240.4 1428.8
## + age      1      37.3 10203.0 1429.1
## + rad      1       7.3 10233.1 1430.5
## - dis      1     498.5 10738.9 1448.4
## - black    1     593.1 10833.5 1452.4
## - ptratio  1    1806.6 12046.9 1500.7
## - rm       1    2617.8 12858.2 1530.3
## - lstat    1    3494.0 13734.4 1560.3
## 
## Step:  AIC=1409.01
## medv ~ lstat + rm + ptratio + black + dis + nox
## 
##           Df Sum of Sq     RSS    AIC
## + chas     1    152.70  9609.4 1403.8
## + crim     1    104.31  9657.7 1406.1
## + zn       1    101.17  9660.9 1406.3
## + rad      1     45.14  9716.9 1408.9
## &lt;none&gt;                  9762.1 1409.0
## + indus    1     35.07  9727.0 1409.4
## + tax      1     16.66  9745.4 1410.2
## + age      1      0.06  9762.0 1411.0
## - black    1    371.20 10133.3 1424.0
## - nox      1    478.30 10240.4 1428.8
## - dis      1    975.84 10737.9 1450.4
## - ptratio  1   2001.87 11763.9 1491.9
## - rm       1   2507.98 12270.0 1511.0
## - lstat    1   2630.69 12392.8 1515.6
## 
## Step:  AIC=1403.84
## medv ~ lstat + rm + ptratio + black + dis + nox + chas
## 
##           Df Sum of Sq     RSS    AIC
## + zn       1    106.42  9502.9 1400.8
## + crim     1     91.99  9517.4 1401.5
## + rad      1     46.33  9563.0 1403.6
## + indus    1     42.67  9566.7 1403.8
## &lt;none&gt;                  9609.4 1403.8
## + tax      1     11.49  9597.9 1405.3
## + age      1      0.15  9609.2 1405.8
## - chas     1    152.70  9762.1 1409.0
## - black    1    342.77  9952.1 1417.8
## - nox      1    512.25 10121.6 1425.5
## - dis      1    927.03 10536.4 1443.7
## - ptratio  1   1877.78 11487.1 1483.0
## - rm       1   2424.02 12033.4 1504.2
## - lstat    1   2552.51 12161.9 1509.0
## 
## Step:  AIC=1400.77
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn
## 
##           Df Sum of Sq     RSS    AIC
## + crim     1    129.27  9373.7 1396.5
## + indus    1     42.86  9460.1 1400.7
## &lt;none&gt;                  9502.9 1400.8
## + tax      1     38.03  9464.9 1401.0
## + rad      1     25.73  9477.2 1401.5
## + age      1      0.72  9502.2 1402.7
## - zn       1    106.42  9609.4 1403.8
## - chas     1    157.95  9660.9 1406.3
## - black    1    358.76  9861.7 1415.6
## - nox      1    518.11 10021.0 1422.9
## - dis      1   1002.05 10505.0 1444.4
## - ptratio  1   1553.73 11056.7 1467.7
## - rm       1   2216.45 11719.4 1494.2
## - lstat    1   2595.46 12098.4 1508.6
## 
## Step:  AIC=1396.54
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn + 
##     crim
## 
##           Df Sum of Sq     RSS    AIC
## + rad      1    124.76  9248.9 1392.4
## + indus    1     42.74  9330.9 1396.5
## &lt;none&gt;                  9373.7 1396.5
## + tax      1      6.71  9367.0 1398.2
## + age      1      0.09  9373.6 1398.5
## - crim     1    129.27  9502.9 1400.8
## - zn       1    143.69  9517.4 1401.5
## - chas     1    143.99  9517.7 1401.5
## - black    1    289.42  9663.1 1408.4
## - nox      1    459.17  9832.8 1416.3
## - dis      1   1078.64 10452.3 1444.1
## - ptratio  1   1344.16 10717.8 1455.5
## - rm       1   2262.97 11636.6 1492.9
## - lstat    1   2263.97 11637.6 1493.0
## 
## Step:  AIC=1392.44
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn + 
##     crim + rad
## 
##           Df Sum of Sq     RSS    AIC
## + tax      1    300.60  8948.3 1379.4
## + indus    1     63.13  9185.8 1391.3
## &lt;none&gt;                  9248.9 1392.4
## + age      1      1.66  9247.2 1394.4
## - zn       1    112.02  9360.9 1395.9
## - rad      1    124.76  9373.7 1396.5
## - chas     1    138.67  9387.6 1397.2
## - crim     1    228.30  9477.2 1401.5
## - black    1    347.10  9596.0 1407.2
## - nox      1    581.51  9830.4 1418.2
## - dis      1   1092.65 10341.6 1441.2
## - ptratio  1   1433.99 10682.9 1456.0
## - rm       1   2077.43 11326.3 1482.6
## - lstat    1   2269.85 11518.8 1490.3
## 
## Step:  AIC=1379.41
## medv ~ lstat + rm + ptratio + black + dis + nox + chas + zn + 
##     crim + rad + tax
## 
##           Df Sum of Sq     RSS    AIC
## &lt;none&gt;                  8948.3 1379.4
## + age      1      3.56  8944.7 1381.2
## + indus    1      0.43  8947.9 1381.4
## - chas     1    105.55  9053.9 1382.8
## - zn       1    186.47  9134.8 1386.8
## - crim     1    247.70  9196.0 1389.8
## - tax      1    300.60  9248.9 1392.4
## - black    1    317.01  9265.3 1393.2
## - nox      1    388.13  9336.4 1396.7
## - rad      1    418.65  9367.0 1398.2
## - dis      1   1207.37 10155.7 1435.0
## - ptratio  1   1229.16 10177.5 1436.0
## - rm       1   1820.89 10769.2 1461.7
## - lstat    1   2229.27 11177.6 1478.6</code></pre>
<hr />
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1>In-class exercises</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise #1</h2>
<p>Please go over the notes once again, make sure you understand the scripts.</p>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise #2</h2>
<p>2.1 Using the crop yeild data, graphically check crop yeilds in different soil density (<code>density</code>) groups; and conduct a one-way ANOVA test to show whether there is a difference in crop yeild average between soil density (<code>density</code>) group.</p>
<p>2.2 Conduct a two-way ANOVA test to show whether changing the soil density type <strong>or</strong> the blocking method impact the crop yeilds.</p>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise #3</h2>
<p>In this exercise, we consider CPU performance from different types. Load the data <code>cpus</code> in the <code>MASS</code> package by:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw">data</span>(cpus)</a></code></pre></div>
<p>3.1 Fit a best subset regression between predictor variable <code>perf</code> and response variables <code>syct</code>, <code>mmin</code>, <code>mmax</code>, <code>cach</code>, <code>chmin</code>, <code>chmax</code>. Try <code>bic</code> and <code>adjr2</code> as the <code>scale</code> argument.</p>
<p>3.2 Try forward, backward, and stepwise regression method for variable selection. Compare your best models obtained by the three methods.</p>
<hr />
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further reading</h1>
<ul>
<li><p><a href="https://daviddalpiaz.github.io/appliedstats/applied_statistics.pdf">Applied Statistics with R</a></p></li>
<li><p><a href="https://bookdown.org/mikemahoney218/LectureBook/basic-statistics-using-r.html">Introduction to Data Exploration and Analysis with R</a></p></li>
<li><p><a href="https://r-statistics.co/">r-statistics</a></p></li>
</ul>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://blog.minitab.com/blog/adventures-in-statistics-2/the-danger-of-overfitting-regression-models">The Danger of Overfitting Regression Models</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p><a href="https://blog.minitab.com/blog/adventures-in-statistics-2/the-danger-of-overfitting-regression-models">The Danger of Overfitting Regression Models</a><a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p><a href="https://xiaoruizhu.github.io/Data-Mining-R/lecture/3_LinearReg.html#compare-model-fit-manually">Regression and Variable Selection</a><a href="#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
