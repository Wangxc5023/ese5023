<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Section 10 Scientific computing with SciPy</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computing and Programming for Environmental Research</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">
    <span class="fa fa-bell-o"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="Schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="Resource.html">
    <span class="fa fa-wrench"></span>
     
    Resource
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Assignment_01.html">Assignment 01</a>
    </li>
    <li>
      <a href="Assignment_02.html">Assignment 02</a>
    </li>
    <li>
      <a href="Assignment_03.html">Assignment 03</a>
    </li>
    <li>
      <a href="Assignment_04.html">Assignment 04</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Section 10 Scientific computing with <code>SciPy</code></h1>

</div>


<blockquote>
<p>“Since its initial release in 2001, <code>SciPy</code> has become a de facto standard for leveraging scientific algorithms in <code>Python</code>.” - Virtanen et al. (2020)</p>
</blockquote>
<hr />
<div id="introduction-to-scipy" class="section level1">
<h1>Introduction to <code>SciPy</code></h1>
<p><code>SciPy</code> is a library of numerical routines for the <code>Python</code> programming language that provides fundamental building blocks for modeling and solving scientific problems. <code>SciPy</code> includes algorithms for optimization, integration, interpolation, eigenvalue problems, algebraic equations, differential equations and many other classes of problems; it also provides specialized data structures, such as sparse matrices and k-dimensional trees. The <code>SciPy</code> library depends on <code>NumPy</code>, which provides convenient and fast N-dimensional array manipulation. Check <a href="https://www.nature.com/articles/s41592-019-0686-2">SciPy 1.0: fundamental algorithms for scientific computing in Python</a> for an overview of the capabilities and development practices of <code>SciPy</code>.</p>
<p>When you want to do scientific work in <code>Python</code>, the first library you can turn to is <code>SciPy</code>. As you’ll see in this Section, <code>SciPy</code> is not just a library, but a whole ecosystem of libraries that work together to help you accomplish complicated scientific tasks quickly and reliably.</p>
<p><code>SciPy</code> should be installed along with <code>Anaconda</code>. If not, in <code>Anaconda Powershell Prompt</code>, install it:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Install SciPy</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>conda install scipy</span></code></pre></div>
<p>To make sure <code>SciPy</code> is installed:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Import SciPy</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> scipy</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Print the location of the file from where `SciPy` is loaded</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="bu">print</span>(scipy.<span class="va">__file__</span>)</span></code></pre></div>
<p>Now you’ve imported <code>SciPy</code> and printed the location of the file from where <code>SciPy</code> is loaded. Your computer will probably show a different location. <code>SciPy</code> should be ready for use.</p>
</div>
<div id="task-specific-sub-modules-in-scipy" class="section level1">
<h1>Task-specific sub-modules in <code>SciPy</code></h1>
<p>As non-professional programmers, scientists often tend to <em>re-invent the wheel</em>, which leads to buggy, non-optimal, difficult-to-share and unmaintainable code. By contrast, <code>SciPy</code>’s routines are optimized and tested, and should therefore be used when possible.</p>
<p><code>SciPy</code> is composed of task-specific sub-modules, including:</p>
<table>
<thead>
<tr class="header">
<th align="left">Sub-module</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/cluster.html#module-scipy.cluster"><code>scipy.cluster</code></a></td>
<td align="left">Vector quantization / Kmeans</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/constants.html#module-scipy.constants"><code>scipy.constants</code></a></td>
<td align="left">Physical and mathematical constants</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack"><code>scipy.fftpack</code></a></td>
<td align="left">Fourier transform</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate"><code>scipy.integrate</code></a></td>
<td align="left">Integration routines</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate"><code>scipy.interpolate</code></a></td>
<td align="left">Interpolation</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io"><code>scipy.io</code></a></td>
<td align="left">Data input and output</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg"><code>scipy.linalg</code></a></td>
<td align="left">Linear algebra routines</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage"><code>scipy.ndimage</code></a></td>
<td align="left">n-dimensional image package</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/odr.html#module-scipy.odr"><code>scipy.odr</code></a></td>
<td align="left">Orthogonal distance regression</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize"><code>scipy.optimize</code></a></td>
<td align="left">Optimization</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal"><code>scipy.signal</code></a></td>
<td align="left">Signal processing</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse"><code>scipy.sparse</code></a></td>
<td align="left">Sparse matrices</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial"><code>scipy.spatial</code></a></td>
<td align="left">Spatial data structures and algorithms</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special"><code>scipy.special</code></a></td>
<td align="left">Special mathematical functions</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats"><code>scipy.stats</code></a></td>
<td align="left">Statistics</td>
</tr>
</tbody>
</table>
<p>This section is far from an introduction to numerical computing. As enumerating the different sub-modules and functions in <code>SciPy</code> would be very boring, we concentrate instead on a few problems you may encounter to give a general idea of how to use <code>SciPy</code> for scientific computing.</p>
<div id="constants-with-scipy.constants" class="section level2">
<h2>Constants with <code>scipy.constants</code></h2>
<p><code>SciPy</code> constants package provides a wide range of constants, which are used in the general scientific area. We have to import the required constant and use them as per the requirement.</p>
<div id="mathematical-constants" class="section level3">
<h3>Mathematical constants</h3>
<p>Import mathematical constant, for example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> scipy <span class="im">import</span> constants</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Mathematical constants</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>scipy.constants.pi</span></code></pre></div>
</div>
<div id="physical-constants" class="section level3">
<h3>Physical constants</h3>
<p>Import physical constant, for example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Physical constants</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>scipy.constants.R</span>
<span id="cb4-3"><a href="#cb4-3"></a>scipy.constants.gas_constant</span></code></pre></div>
<p>In addition to the above variables, <code>scipy.constants</code> also contains the <a href="https://physics.nist.gov/cuu/Constants">2018 CODATA recommended values (CODATA2018)</a> database containing more physical constants. Call <code>scipy.constants.physical_constants[NAME]</code> to return a dictionary of physical constants, of the format <code>(value, unit, uncertainty)</code>. For example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Physical constants</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>scipy.constants.physical_constants[<span class="st">&#39;atomic unit of mass&#39;</span>]</span></code></pre></div>
</div>
<div id="units" class="section level3">
<h3>Units</h3>
<p><code>scipy.constants</code> also contains SI units, for example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># SI prefixes</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>scipy.constants.micro</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Mass, in [kg]</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>scipy.constants.long_ton</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co"># Speed, in [m/s]</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>scipy.constants.mph</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co"># Pressure, in [Pa]</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>scipy.constants.atmosphere</span></code></pre></div>
<p>Remembering all of these are a bit tough. The easy way to get which key is for which function is looking up things in the <a href="https://docs.scipy.org/doc/scipy/reference/constants.html#module-scipy.constants"><code>SciPy</code> Constants page</a>.</p>
</div>
</div>
<div id="integrating-with-scipy.integrate" class="section level2">
<h2>Integrating with <code>scipy.integrate</code></h2>
<p>When a function cannot be integrated analytically, or is very difficult to integrate analytically, one generally turns to numerical integration methods. <code>SciPy</code> has a number of routines for performing numerical integration. Most of them are found in the same <code>scipy.integrate</code> library. For example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">from</span> numpy <span class="im">import</span> exp</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="im">from</span> scipy <span class="im">import</span> integrate</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Define a function</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>f <span class="op">=</span> <span class="kw">lambda</span> x:exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># Single integral of f from 0 to 1</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>res <span class="op">=</span> integrate.quad(f, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="bu">print</span>(res)</span></code></pre></div>
<p>Here we use a <a href="https://realpython.com/python-lambda/">lambda expression</a> and then call the quadrature method (for single integrals) on that function. The <code>quad</code> function returns the two values, in which the first number is the value of integral and the second value is the estimate of the absolute error in the value of integral. For multiple integrals or solving initial value problems for ODE systems, check <a href="https://docs.scipy.org/doc/scipy/reference/integrate.html">Integration and ODEs</a>.</p>
</div>
<div id="interpolation-with-scipy.interpolate" class="section level2">
<h2>Interpolation with <code>scipy.interpolate</code></h2>
<div id="linear-interpolation" class="section level3">
<h3>Linear interpolation</h3>
<p>Interpolation is the process of finding a value between two points on a line or a curve. This tool, interpolation, is not only useful in statistics, but is also useful in science, business, or when there is a need to predict values that fall within two existing data points.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Make up some data points</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">12</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>y <span class="op">=</span> np.cos(x<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># Plot data</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>plt.plot(x, y,<span class="st">&#39;ko&#39;</span>)</span></code></pre></div>
<p>Suppose we want to find the value of <code>y</code> when <code>x=3.12</code>, you can use <code>interp1d()</code> as:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> interp1d</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># Using interp1d function</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>f1 <span class="op">=</span> interp1d(x, y, kind <span class="op">=</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>f2 <span class="op">=</span> interp1d(x, y, kind <span class="op">=</span> <span class="st">&#39;cubic&#39;</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Now make x finer</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>xnew <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">30</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># Plot interpolated values</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>plt.plot(x, y, <span class="st">&#39;ko&#39;</span>, xnew, f1(xnew), <span class="st">&#39;-&#39;</span>, xnew, f2(xnew), <span class="st">&#39;--&#39;</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co"># Add legend</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>plt.legend([<span class="st">&#39;data&#39;</span>, <span class="st">&#39;linear&#39;</span>, <span class="st">&#39;cubic&#39;</span>], loc <span class="op">=</span> <span class="st">&#39;best&#39;</span>)</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># Show data at a specific location</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="bu">print</span>(f1(<span class="fl">3.12</span>), f2(<span class="fl">3.12</span>))</span></code></pre></div>
<p>The <code>interp1d()</code> function in the <code>scipy.interpolate</code> is a convenient method to create a function based on fixed data points, which can be evaluated anywhere within the domain defined by the given data using linear interpolation. Using the <code>interp1d()</code> function, we created two functions <code>f1</code> and <code>f2</code>. These functions, for a given input <code>x</code> returns <code>y</code>. The third variable kind represents the type of the interpolation technique. <code>linear</code>, <code>nearest</code>, <code>zero</code>, <code>slinear</code>, <code>quadratic</code>, <code>cubic</code> are a few techniques of interpolation.</p>
</div>
<div id="spline-interpolation" class="section level3">
<h3>Spline interpolation</h3>
<p>One-dimensional smoothing spline fits a given set of data points. The <code>univariatespline</code> function in <code>scipy.interpolate</code> is a convenient method to create a function, based on fixed data points class.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Make up some data points</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">50</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>y <span class="op">=</span> np.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(<span class="dv">50</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># Plot data</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>plt.plot(x, y, <span class="st">&#39;ko&#39;</span>)</span></code></pre></div>
<p>Suppose we want to find the value of <code>y</code> when <code>x=1.23</code>, you can use <code>UnivariateSpline()</code> as:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> UnivariateSpline</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># Using UnivariateSpline function</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>spl <span class="op">=</span> UnivariateSpline(x, y, k<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>spl.set_smoothing_factor(<span class="fl">0.5</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co"># Now make x finer</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>xnew <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1000</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co"># Plot interpolated values</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>plt.plot(x, y, <span class="st">&#39;ko&#39;</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>plt.plot(xnew, spl(xnew), <span class="st">&#39;b&#39;</span>, lw <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co"># Show data at a specific location</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>spl(<span class="fl">1.23</span>)</span></code></pre></div>
</div>
</div>
<div id="optimization-and-fitting-with-scipy.optimize" class="section level2">
<h2>Optimization and fitting with <code>scipy.optimize</code></h2>
<div id="curve-fitting" class="section level3">
<h3>Curve fitting</h3>
<p>Suppose we have data on a sine wave, with some noise:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Make up some data points</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, num<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>y <span class="op">=</span> <span class="fl">2.9</span> <span class="op">*</span> np.sin(<span class="fl">1.5</span> <span class="op">*</span> x) <span class="op">+</span> np.random.normal(size<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Plot data</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>plt.plot(x, y, <span class="st">&#39;ko&#39;</span>)</span></code></pre></div>
<p>If we know that the data lies on a sine wave, but not the amplitudes or the period, we can find those by least squares curve fitting. First we have to define the test function to fit, here a sine with unknown amplitude and period:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Define the function to fit</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">def</span> guess_func(x, a, b):</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="cf">return</span> a <span class="op">*</span> np.sin(b <span class="op">*</span> x)</span></code></pre></div>
<p>We then use <code>scipy.optimize.curve_fit</code> to find <code>a</code> and <code>b</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">from</span> scipy <span class="im">import</span> optimize</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># Fit parameters</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>params, _ <span class="op">=</span> optimize.curve_fit(guess_func, x, y)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="bu">print</span>(params)</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># Plot fitted data</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>plt.plot(x, y, <span class="st">&#39;ko&#39;</span>, x, params[<span class="dv">0</span>]<span class="op">*</span>np.sin(params[<span class="dv">1</span>] <span class="op">*</span> x), <span class="st">&#39;r-&#39;</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># Add legend</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>plt.legend([<span class="st">&#39;data&#39;</span>, <span class="st">&#39;fitted value&#39;</span>], loc <span class="op">=</span> <span class="st">&#39;best&#39;</span>)</span></code></pre></div>
</div>
<div id="finding-the-minimums" class="section level3">
<h3>Finding the minimums</h3>
<p>Let’s define the following function and plot it:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Define a function</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">def</span> g(x):</span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">20</span><span class="op">*</span>np.sin(x)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># Set the range</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co"># Plot the function</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>plt.plot(x, g(x)) </span></code></pre></div>
<p>This function has a global minimum around <code>-1.5</code> and local minimums around <code>-7.1</code> and <code>4.3</code>. Searching for minimum can be done with <code>scipy.optimize.minimize</code>, given a starting point <code>x0</code>, it returns the location of the minimum that it has found.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Using minimize() to search for minimums</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>result <span class="op">=</span> optimize.minimize(g, x0<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>result</span></code></pre></div>
</div>
<div id="finding-the-roots" class="section level3">
<h3>Finding the roots</h3>
<p>To find a root, i.e. a point where <code>g(x) = 0</code>, of the function <code>g</code> above we can use <code>scipy.optimize.root</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Using root() to find the roots</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>root <span class="op">=</span> optimize.root(g, x0<span class="op">=</span><span class="dv">1</span>) </span>
<span id="cb17-3"><a href="#cb17-3"></a>root</span></code></pre></div>
</div>
</div>
<div id="statistics-with-scipy.stats" class="section level2">
<h2>Statistics with <code>scipy.stats</code></h2>
<p>The module <code>scipy.stats</code> contains statistical tools and probabilistic descriptions of random processes.</p>
<p>For example, we can fit a sample to a distribution:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Generate a sample</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>sample <span class="op">=</span> np.random.normal(size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co"># Fit a normal distribution</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>stats.norm.fit(sample)</span></code></pre></div>
<p>A statistical test is a decision indicator. For instance, if we have two sets of observations, that we assume are generated from normal distributions, we can use a <em>t-test</em> to decide whether the means of two sets of observations are significantly different:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Sample 1</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>sample1 <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># Sample 2</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>sample2 <span class="op">=</span> np.random.normal(<span class="dv">1</span>, <span class="dv">1</span>, size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co"># Independent t-test</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>stats.ttest_ind(sample1, sample2) </span></code></pre></div>
<p><a href="https://scipy-lectures.org/index.html">The chapter on statistics</a> introduces much more elaborate tools for statistical testing and statistical data loading and visualization outside of <code>SciPy</code>. You are also welcome to check <a href="https://zhu-group.github.io/ese335/index.html">ESE335 Environmental Data Analysis</a> for conducting statistical tests with the <code>R</code> language.</p>
</div>
<div id="clustering-with-scipy.cluster" class="section level2">
<h2>Clustering with <code>scipy.cluster</code></h2>
<p>Clustering is a popular technique to categorize data by associating it into groups. The <code>SciPy</code> library includes an implementation of the <em>k-means clustering</em> algorithm as well as several <em>hierarchical clustering</em> algorithms. Here we will be using the k-means algorithm in <code>scipy.cluster.vq</code>, where <code>vq</code> stands for vector quantization.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">from</span> numpy <span class="im">import</span> vstack,array</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="im">from</span> numpy.random <span class="im">import</span> rand</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="im">from</span> scipy.cluster.vq <span class="im">import</span> kmeans,vq</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># Data generation, 200 rows, 2 cols</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>data <span class="op">=</span> vstack((rand(<span class="dv">100</span>,<span class="dv">2</span>) <span class="op">+</span> array([.<span class="dv">8</span>,.<span class="dv">8</span>]), rand(<span class="dv">100</span>,<span class="dv">2</span>)))</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co"># Show data</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>plt.plot(data[:,<span class="dv">0</span>],data[:,<span class="dv">1</span>],<span class="st">&#39;k+&#39;</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co"># Computing K-Means with K = 2 (2 clusters)</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#centroids, mean_dist = kmeans(data,2)</span></span>
<span id="cb20-13"><a href="#cb20-13"></a></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co"># Assign each sample to a cluster</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">#clusters, dist = vq(data,centroids)</span></span>
<span id="cb20-16"><a href="#cb20-16"></a></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co"># Plot clusters</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#plt.plot(data[clusters==0][:,0], data[clusters==0][:,1],&#39;bo&#39;)</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co">#plt.plot(data[clusters==1][:,0], data[clusters==1][:,1],&#39;rd&#39;)</span></span>
<span id="cb20-20"><a href="#cb20-20"></a></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co"># Plot cluster centroids</span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co">#plt.plot(centroids[:,0],centroids[:,1],&#39;gX&#39;,markersize=10)</span></span>
<span id="cb20-23"><a href="#cb20-23"></a></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co"># Plot raw data</span></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="co">#plt.plot(data[:,0],data[:,1],&#39;w+&#39;)</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1>In-class exercises</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise #1</h2>
<p>Go through the notes, make sure you understand the scripts.</p>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise #2</h2>
<p>The temperature extremes in Shenzhen for each month, starting in January, are given by (in degrees Celcius):</p>
<p><code>max: 19.8, 20.2, 22.7, 26.3, 29.5, 31.1, 32.3, 32.3, 31.3, 29.2, 25.4, 21.5</code> <code>min: 12.5, 13.8, 16.5, 20.3, 23.6, 25.6, 26.3, 26.1, 25.0, 22.5, 18.2, 13.8</code></p>
<p><strong>2.1</strong> Plot these temperature extremes.<br />
<strong>2.2</strong> Define a function that can describe min and max temperatures.<br />
[Hint]: this function has to have a period of 1 year.<br />
<strong>2.3</strong> Fit this function to the data with <code>scipy.optimize.curve_fit</code>.<br />
<strong>2.4</strong> Plot the result. Is the fit reasonable? If not, why?<br />
<strong>2.5</strong> Is the time offset for min and max temperatures the same within the fit accuracy?</p>
<hr />
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further reading</h1>
<ul>
<li><a href="https://docs.scipy.org/doc/scipy/tutorial/index.html">SciPy User Guide</a><br />
</li>
<li><a href="https://www.w3schools.com/python/scipy/index.php">SciPy Tutorial</a></li>
<li><a href="https://realpython.com/python-scipy-cluster-optimize/">Scientific Python: Using SciPy for Optimization</a></li>
<li><a href="https://www.tutorialspoint.com/scipy/scipy_quick_guide.htm">SciPy - Quick Guide</a></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
